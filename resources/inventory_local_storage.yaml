# Fichier YAML généré à partir de JSON
# Structure of the file
# ---
# Category is a nom to group resource in the final inventory. Ex: 'Compute' for 'ec2', 'Storage' for 'efs', 'fsx', 'glacier', etc.
# boto_resource_name is the name of the boto3 resource to use to interact with the service. Generally, it is the name of the service in the AWS SDK, but sometime it may differ.
# region_type is the type of region where the service is available. It can be 'local' or 'global'.
#
# inventory_nodes is a list of functions to call to get the inventory of the service. Most of the time, you will have only one function to call, but you can have more if needed.
# Each function is a dictionary with the following keys:
# - item_key: the key in the response where the list of items is stored.
# - item_search_id: the key in the item to use as an identifier for the detailed inventory functions.
# - permissions: the list of permissions needed to call the function.
# - detail_param: the parameter to use to call the detailed inventory functions.
# - result_key: the key in the response where the detailed inventory is stored.

s3:
    region_type: global
    boto_resource_name: s3
    category: Storage
    inventory_nodes:
        list_buckets:
            permissions: ListBuckets
            item_key: Buckets
            details:
                LocationConstraint:
                    permissions: GetBucketLocation
                    item_search_id: Name
                    detail_function: get_bucket_location
                    detail_param: Bucket
                ServerSideEncryptionConfiguration:
                    permissions: GetBucketEncryption
                    item_search_id: Name
                    detail_function: get_bucket_encryption
                    detail_param: Bucket
                Website:
                    permissions: GetBucketWebsite
                    item_search_id: Name
                    detail_function: get_bucket_website
                    detail_param: Bucket
                TagSet:
                    permissions: GetBucketTagging
                    item_search_id: Name
                    detail_function: get_bucket_tagging
                    detail_param: Bucket

elasticfilesystem:
    region_type: local
    boto_resource_name: elasticfilesystem
    category: Storage
    inventory_nodes:
        describe_file_systems:
            permissions: DescribeFileSystems
            item_key: 'FileSystems'

fsx:
    region_type: local
    boto_resource_name: fsx
    category: Storage
    inventory_nodes:
        describe_backups:
            permissions: DescribeBackups
            item_key: 'Backups'
            details:
                backups:
                    permissions: DescribeBackup
                    item_search_id: BackupId
                    detail_function: describe_backup
                    detail_param: BackupId
        describe_volumes:
            permissions: DescribeVolumes
            item_key: 'Volumes'
        describe_storage_virtual_machines:
            permissions: DescribeStorageVirtualMachines
            item_key: StorageVirtualMachines
        describe_file_systems:
            permissions: DescribeFileSystems
            item_key: FileSystems
            
glacier:
    region_type: local
    boto_resource_name: glacier
    category: Storage
    inventory_nodes:
        list_vaults:
            permissions: ListVaults
            item_key: 'VaultList'
            details:
                vaults:
                    permissions: DescribeVault
                    item_search_id: VaultName
                    detail_function: describe_vault
                    detail_param: vaultName
        list_provisioned_capacity:
            permissions: ListProvisionedCapacity
            item_key: 'ProvisionedCapacityList'
            

